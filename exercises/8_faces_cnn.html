<h2 id="faces-with-convolutional-neural-networks">8 faces with convolutional neural networks</h2>
<p>Hint: the training of the networks takes some time because we compute only on the cpu.<br />
(up to 1h with the last network)</p>
<ol style="list-style-type: lower-alpha">
<li>Open the notebook <a href="https://github.com/tensorchiefs/dl_course/blob/master/notebooks/10_8_faces_cnn.ipynb">8 faces cnn</a> and bulit this network and then train it.<br />
Do you expect it to be better then the last one with only fully connected layers?<br />
How good is the model? Look at the train valid and test accuracy.</li>
</ol>
<pre><code>____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to                     
====================================================================================================
convolution2d_1 (Convolution2D)  (None, 48, 48, 32)    896         convolution2d_input_1[0][0]      
____________________________________________________________________________________________________
activation_1 (Activation)        (None, 48, 48, 32)    0           convolution2d_1[0][0]            
____________________________________________________________________________________________________
convolution2d_2 (Convolution2D)  (None, 48, 48, 32)    9248        activation_1[0][0]               
____________________________________________________________________________________________________
activation_2 (Activation)        (None, 48, 48, 32)    0           convolution2d_2[0][0]            
____________________________________________________________________________________________________
maxpooling2d_1 (MaxPooling2D)    (None, 24, 24, 32)    0           activation_2[0][0]               
____________________________________________________________________________________________________
convolution2d_3 (Convolution2D)  (None, 24, 24, 64)    18496       maxpooling2d_1[0][0]             
____________________________________________________________________________________________________
activation_3 (Activation)        (None, 24, 24, 64)    0           convolution2d_3[0][0]            
____________________________________________________________________________________________________
convolution2d_4 (Convolution2D)  (None, 24, 24, 64)    36928       activation_3[0][0]               
____________________________________________________________________________________________________
activation_4 (Activation)        (None, 24, 24, 64)    0           convolution2d_4[0][0]            
____________________________________________________________________________________________________
maxpooling2d_2 (MaxPooling2D)    (None, 12, 12, 64)    0           activation_4[0][0]               
____________________________________________________________________________________________________
flatten_1 (Flatten)              (None, 9216)          0           maxpooling2d_2[0][0]             
____________________________________________________________________________________________________
dense_1 (Dense)                  (None, 200)           1843400     flatten_1[0][0]                  
____________________________________________________________________________________________________
activation_5 (Activation)        (None, 200)           0           dense_1[0][0]                    
____________________________________________________________________________________________________
dense_2 (Dense)                  (None, 8)             1608        activation_5[0][0]               
____________________________________________________________________________________________________
activation_6 (Activation)        (None, 8)             0           dense_2[0][0]                    
====================================================================================================
Total params: 1,910,576
Trainable params: 1,910,576
Non-trainable params: 0
____________________________________________________________________________________________________</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>Now let's add the tricks which we already used on the MNIST dataset.<br />
Restart the notebook and built the same network as above and add dropout layers, see below.<br />
How good is the model now? Look at the train valid and test accuracy.</li>
</ol>
<pre><code>____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to                     
====================================================================================================
convolution2d_1 (Convolution2D)  (None, 48, 48, 32)    896         convolution2d_input_1[0][0]      
____________________________________________________________________________________________________
activation_1 (Activation)        (None, 48, 48, 32)    0           convolution2d_1[0][0]            
____________________________________________________________________________________________________
convolution2d_2 (Convolution2D)  (None, 48, 48, 32)    9248        activation_1[0][0]               
____________________________________________________________________________________________________
activation_2 (Activation)        (None, 48, 48, 32)    0           convolution2d_2[0][0]            
____________________________________________________________________________________________________
maxpooling2d_1 (MaxPooling2D)    (None, 24, 24, 32)    0           activation_2[0][0]               
____________________________________________________________________________________________________
dropout_1 (Dropout)              (None, 24, 24, 32)    0           maxpooling2d_1[0][0]             
____________________________________________________________________________________________________
convolution2d_3 (Convolution2D)  (None, 24, 24, 64)    18496       dropout_1[0][0]                  
____________________________________________________________________________________________________
activation_3 (Activation)        (None, 24, 24, 64)    0           convolution2d_3[0][0]            
____________________________________________________________________________________________________
convolution2d_4 (Convolution2D)  (None, 24, 24, 64)    36928       activation_3[0][0]               
____________________________________________________________________________________________________
activation_4 (Activation)        (None, 24, 24, 64)    0           convolution2d_4[0][0]            
____________________________________________________________________________________________________
maxpooling2d_2 (MaxPooling2D)    (None, 12, 12, 64)    0           activation_4[0][0]               
____________________________________________________________________________________________________
dropout_2 (Dropout)              (None, 12, 12, 64)    0           maxpooling2d_2[0][0]             
____________________________________________________________________________________________________
flatten_1 (Flatten)              (None, 9216)          0           dropout_2[0][0]                  
____________________________________________________________________________________________________
dense_1 (Dense)                  (None, 200)           1843400     flatten_1[0][0]                  
____________________________________________________________________________________________________
activation_5 (Activation)        (None, 200)           0           dense_1[0][0]                    
____________________________________________________________________________________________________
dropout_3 (Dropout)              (None, 200)           0           activation_5[0][0]               
____________________________________________________________________________________________________
dense_2 (Dense)                  (None, 8)             1608        dropout_3[0][0]                  
____________________________________________________________________________________________________
activation_6 (Activation)        (None, 8)             0           dense_2[0][0]                    
====================================================================================================
Total params: 1,910,576
Trainable params: 1,910,576
Non-trainable params: 0
____________________________________________________________________________________________________</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>Finally add batchnormalization to your network.<br />
Restart the notebook and built the same network as above and add batchnormalization layers, see below.<br />
How good is the model now? Look at the train valid and test accuracy.</li>
</ol>
<pre><code>____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to                     
====================================================================================================
convolution2d_1 (Convolution2D)  (None, 48, 48, 32)    896         convolution2d_input_1[0][0]      
____________________________________________________________________________________________________
batchnormalization_1 (BatchNorma (None, 48, 48, 32)    128         convolution2d_1[0][0]            
____________________________________________________________________________________________________
activation_1 (Activation)        (None, 48, 48, 32)    0           batchnormalization_1[0][0]       
____________________________________________________________________________________________________
convolution2d_2 (Convolution2D)  (None, 48, 48, 32)    9248        activation_1[0][0]               
____________________________________________________________________________________________________
batchnormalization_2 (BatchNorma (None, 48, 48, 32)    128         convolution2d_2[0][0]            
____________________________________________________________________________________________________
activation_2 (Activation)        (None, 48, 48, 32)    0           batchnormalization_2[0][0]       
____________________________________________________________________________________________________
maxpooling2d_1 (MaxPooling2D)    (None, 24, 24, 32)    0           activation_2[0][0]               
____________________________________________________________________________________________________
dropout_1 (Dropout)              (None, 24, 24, 32)    0           maxpooling2d_1[0][0]             
____________________________________________________________________________________________________
convolution2d_3 (Convolution2D)  (None, 24, 24, 64)    18496       dropout_1[0][0]                  
____________________________________________________________________________________________________
batchnormalization_3 (BatchNorma (None, 24, 24, 64)    256         convolution2d_3[0][0]            
____________________________________________________________________________________________________
activation_3 (Activation)        (None, 24, 24, 64)    0           batchnormalization_3[0][0]       
____________________________________________________________________________________________________
convolution2d_4 (Convolution2D)  (None, 24, 24, 64)    36928       activation_3[0][0]               
____________________________________________________________________________________________________
batchnormalization_4 (BatchNorma (None, 24, 24, 64)    256         convolution2d_4[0][0]            
____________________________________________________________________________________________________
activation_4 (Activation)        (None, 24, 24, 64)    0           batchnormalization_4[0][0]       
____________________________________________________________________________________________________
maxpooling2d_2 (MaxPooling2D)    (None, 12, 12, 64)    0           activation_4[0][0]               
____________________________________________________________________________________________________
dropout_2 (Dropout)              (None, 12, 12, 64)    0           maxpooling2d_2[0][0]             
____________________________________________________________________________________________________
flatten_1 (Flatten)              (None, 9216)          0           dropout_2[0][0]                  
____________________________________________________________________________________________________
dense_1 (Dense)                  (None, 200)           1843400     flatten_1[0][0]                  
____________________________________________________________________________________________________
batchnormalization_5 (BatchNorma (None, 200)           800         dense_1[0][0]                    
____________________________________________________________________________________________________
activation_5 (Activation)        (None, 200)           0           batchnormalization_5[0][0]       
____________________________________________________________________________________________________
dropout_3 (Dropout)              (None, 200)           0           activation_5[0][0]               
____________________________________________________________________________________________________
dense_2 (Dense)                  (None, 8)             1608        dropout_3[0][0]                  
____________________________________________________________________________________________________
activation_6 (Activation)        (None, 8)             0           dense_2[0][0]                    
====================================================================================================
Total params: 1,912,144
Trainable params: 1,911,360
Non-trainable params: 784
____________________________________________________________________________________________________</code></pre>
